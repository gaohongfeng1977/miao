
<!-- saved from url=(0028)file:///D:/a01/web/Code.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" charset="utf-8" href="./Code_files/Textstyle.css">
</head>
<script>

let confirmok = 0

function add_quest()
{
// document.getElementById("scrool1").scrollTop($('#scrool1')[0].scrollHeight);
quest = document.getElementById("val_quest").value;


let fatherdiv = document.getElementById("maintable");

let div1 = document.createElement("tr");
div1.innerHTML =`<td style="align:right"> <div style=" height: 32px; left: 0px; top: 155px; position: relative"> \
                <div style="color:#FFFFFF; right:5px; top: 0px; position: absolute; background: #FFBD0A; border-radius: 20px">${quest}</div> \
            </div></td>`;

fatherdiv.appendChild(div1);


xhr.open('get', `http://localhost:8089/getquest?quest=${quest}`);

xhr.send();

 //4.注册响应完成事件
/*
这个事件不会立即执行,而是等服务器响应之后才会执行
时间不固定:取决于带宽、请求大小、高峰期等等因素
*/
xhr.onload = function () {
    // 获取数据时可能获取的是JSON格式,需要进行转换
    console.log(xhr.responseText);
    // 将json数据转成js对象
    let res = JSON.parse(xhr.responseText);
    //获取服务器响应数据
    add_answer(`${res.data.choices[0].content.replaceAll("\\n","<br>")}`);

}


}

function add_answer(quest)
{

let fatherdiv = document.getElementById("maintable");

let div2 = document.createElement("tr");
// div2.innerHTML ='<td><div style="width: 350px;  padding-top: 17px; padding-bottom: 13px; padding-left: 24px; padding-right: 23px; left: 0px; top: 350px; position: absolute; background: linear-gradient(90deg, #FDFDFD 0%, #F3F6F8 50%, #F1F3F5 100%); box-shadow: 0px 0px 10px rgba(65, 69, 85, 0.10) inset; border-radius: 22px; overflow: hidden; border: 2px white solid; justify-content: center; align-items: center; display: inline-flex">\
//                 <div style="width: 303px; height: 266px; color: #494949; font-size: 17px; font-family: Poppins; font-weight: 300; line-height: 22px; word-wrap: break-word"><p>如果猫咪出现打架症状，猫咪的肠胃得到休息。然后，可以给猫咪喝一些温开水，帮助猫咪清理肠胃。<br>如果猫咪的打架症状持续，可以尝试喂食一些化毛膏或猫草，帮助猫咪排出毛球。</p></div>\
//             </div></td>';
div2.innerHTML =`<td><div style="width: 350px; left: 16px; top: 155px; position: relative"> \
                <div style="width: 350px; left: 0px; top: 0px;  background: #e3e6e8; border-radius: 20px;padding: 5px;"> \
                <div style="left: 19px; top: 5px; color: black; font-size: 18px; font-family: Poppins; font-weight: 400; line-height: 21px; word-wrap: break-word">${quest}<br><br></div> \
            	</div></div></td>`;


fatherdiv.appendChild(div2);



}

function confirmYesNo(){

	if (confirmok == 1) {
		return;
	}

	confirmok = 1;

	let fatherdiv = document.getElementById("maintable");

	let div1 = document.createElement("tr");
	div1.innerHTML ='<td> <div style="width: 110.94px; height: 32px; left: 236px; top: 155px; position: relative"> \
	                <div style="width: 110.94px; height: 32px; left: 0px; top: 0px; position: absolute; background: #FFBD0A; border-radius: 20px"></div> \
	                <div style="left: 19px; top: 5px; position: absolute; color: white; font-size: 18px; font-family: Poppins; font-weight: 400; line-height: 21px; word-wrap: break-word">猫咪打架</div> \
	            </div></td>';

	fatherdiv.appendChild(div1);

	let div2 = document.createElement("tr");
	div2.innerHTML =
		'<td><div style="width: 350px; left: 16px; top: 155px; position: relative"> \
	                <div style="width: 350px; left: 0px; top: 0px;  background: #e3e6e8; border-radius: 20px;padding: 5px;"> \
	                <div style="left: 19px; top: 5px; color: black; font-size: 18px; font-family: Poppins; font-weight: 400; line-height: 21px; word-wrap: break-word">哎呀呀，打架受伤的是猫咪酷宝吗？</div> \
	            </div></div></td>';
	fatherdiv.appendChild(div2);	

	// let def_quest = "你是一个宠物医生，下面问的问题跟猫咪酷宝打架受伤有关。猫咪酷宝受伤了，怎么处理？";
	let def_quest = "猫咪酷宝打架受伤了，吃什么药？";

	let div3 = document.createElement("tr");
	let htmlstr = `<td><div style="width: 356px; left: 10px; top: 150px; position: relative">\
	        <div style="width: 56px;  right: 0px; top: 0px; position: absolute; background: #FFBD0A; border-radius: 20px">\
	            <table><tr><td><input id=sayyes value=" 否"  type=button  style="color:white;background: #FFBD0A; border: 0px;left: 5px;" ></td></tr></table>\
	        </div>\
	         <div style="width: 56px; left: 0px; top: 0px; position: relative; background: #FFBD0A; border-radius: 20px">\
	            <table><tr><td style="align-content: center;"><input id=sayyes value=" 是"  type=button  style="color:white;background: #FFBD0A; border: 0px;left: 5px;" onclick=question_yes("${def_quest}") ></td></tr></table>\
	        </div>\
	    </div></td>`

	// let htmlstr = '<td><div style="width: 356px; left: 10px; top: 150px; position: relative">\
	//         <div style="width: 56px;  right: 0px; top: 0px; position: absolute; background: #FFBD0A; border-radius: 20px">\
	//             <table><tr><td><input id=sayyes value=" 否"  type=button  style="color:white;background: #FFBD0A; border: 0px;left: 5px;" ></td></tr></table>\
	//         </div>\
	//          <div style="width: 56px; left: 0px; top: 0px; position: relative; background: #FFBD0A; border-radius: 20px">\
	//             <table><tr><td style="align-content: center;"><input id=sayyes value=" 是"  type=button  style="color:white;background: #FFBD0A; border: 0px;left: 5px;" onclick=question_yes(quest="'+"test"+'") ></td></tr></table>\
	//         </div>\
	//     </div></td>'

	div3.innerHTML = htmlstr;
	console.log(htmlstr);
	// console.log(div3.innerHTML);
	fatherdiv.appendChild(div3);
}

let xhr = new XMLHttpRequest()

function question_yes(quest){

	 
	//调用智谱大模型
	// xhr.open('post','http://localhost:8889/getquest');


	// //设置请求头 : 只有post请求才需要
	// //请求头的格式是固定的
	// xhr.setRequestHeader('Content-type','application/x-www-form-urlencoded');
	// xhr.setRequestHeader("Access-Control-Allow-Origin", "*");
	// //发送请求(sned里面的内容是请求体,传入属性名和属性值,根据实际情况传参)
	// xhr.send('prompt=${quest}');
	// console.log(xhr.responseText);
	// // let res = JSON.parse(xhr.responseText);
	// // add_answer(res);

	xhr.open('get', `http://localhost:8089/getquest?quest=${quest}`);

 	xhr.send();

 	 //4.注册响应完成事件
        /*
        这个事件不会立即执行,而是等服务器响应之后才会执行
        时间不固定:取决于带宽、请求大小、高峰期等等因素
        */
        xhr.onload = function () {
            // 获取数据时可能获取的是JSON格式,需要进行转换
            console.log(xhr.responseText);
            // 将json数据转成js对象
            let res = JSON.parse(xhr.responseText);
            //获取服务器响应数据
            add_answer(`${res.data.choices[0].content.replaceAll("\\n","<br>")}`);
        }

}

</script>
<body>

<div id = "scrool1" style="width: 100%; height: 100%; position: relative; background: #EFF1F5; border-radius: 30px; overflow: hidden; overflow: auto">
 <div id="divmain" style="width: 163px; height: 98px; left: 24px; top: 33px; position: absolute">
        <div style="left: 0px; top: 0px; position: absolute; color: rgba(0, 0, 0, 0.05); font-size: 65px; font-family: Poppins; font-weight: 700; text-transform: uppercase; letter-spacing: 2.60px; word-wrap: break-word">INFO</div>
        <div style="left: 19px; top: 23px; position: absolute; color: rgba(0, 0, 0, 0.98); font-size: 28px; font-family: Poppins; font-weight: 700; letter-spacing: 0.62px; word-wrap: break-word">Pet Chat </div>
    </div>

    <div style="width: 350px; height: 127px; left: 0px; top: 150px; position: relative; box-shadow: 0px 4px 11px rgba(0, 0, 0, 0.25)">
                
                <div style="padding-top: 9px; padding-bottom: 10px; padding-left: 23px; padding-right: 7px; left: 32px; top: 64px; position: absolute; background: linear-gradient(91deg, rgba(251.90, 66.59, 66.59, 0.68) 0%, rgba(252.96, 62.66, 165.42, 0.68) 52%, rgba(251.09, 131.82, 224.85, 0.76) 100%); box-shadow: 10px 4px 13px rgba(182, 194, 205, 0.30) inset; border-radius: 10px; overflow: hidden; justify-content: flex-end; align-items: center; gap: 185px; display: inline-flex">
                    <div style="color: white; font-size: 18px; font-family: Lexend; font-weight: 600; line-height: 21px; word-wrap: break-word"
                    	onclick="confirmYesNo()" 
                    >猫咪打架</div>
                    <div style="width: 8px; height: 16px; border: 3px white solid"></div>
                </div>
                <div style="width: 311px; height: 44px; left: 32px; top: 17px; position: relative; color: #494949; font-size: 17px; font-family: Poppins; font-weight: 300; line-height: 22px; word-wrap: break-word">铲屎官你来啦？今天毛孩子表现的很好，你有什么需要我帮忙的吗？</div>
    </div>
    <div>
    	<table id="maintable"></table>    	
    </div>
 
    <div style="width: 311px; height: 30px; left: 0px;bottom: 0;  position: fixed; color: #494949; font-size: 17px; font-family: Poppins; font-weight: 300; line-height: 22px; word-wrap: break-word">
    	 <form>
	    	<table>
	    		<tr><td><input id="val_quest" type="text" name="" value="" width="300" ></td>
	    		<td><input type="button" name="" value="提问" onclick=add_quest()></td>
		    	</tr>
		    </table>
		</form>
    </div>



</div>

</body></html>